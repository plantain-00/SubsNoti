machine:
  node:
    version: 4.1.0

dependencies:
  pre:
    - sudo apt-get update
    - sudo apt-get install libcairo2-dev libjpeg8-dev libpango1.0-dev libgif-dev build-essential g++
    - npm install typescript@next -g
    - npm install tsd -g
    - npm install gitbook-cli -g

test:
  pre:
    - tsd update -so

  override:
    - tsc
    - tsc -p frontends
    - tsc -p backends
    - mocha publish/backends/tests
    - NODE_ENV=production gulp js
    - NODE_ENV=production gulp css
    - NODE_ENV=production gulp rev
    - NODE_ENV=production gulp html
    - NODE_ENV=production gulp doc
    - NODE_ENV=production gulp dot
    - NODE_ENV=production gulp icon
